Instruction:
What is the average price of products in clothing category ordered in the last 7 days?
Index:
ecommerce
Fields:
- category: text ("Men's Clothing")
- currency: keyword ("EUR")
- customer_birth_date: date (null)
- customer_first_name: text ("Eddie")
- customer_full_name: text ("Eddie Underwood")
- customer_gender: keyword ("MALE")
- customer_id: keyword ("38")
- customer_last_name: text ("Underwood")
- customer_phone: keyword ("")
- day_of_week: keyword ("Monday")
- day_of_week_i: integer (0)
- email: keyword ("eddie@underwood-family.zzz")
- event.dataset: keyword ("sample_ecommerce")
- geoip.city_name: keyword ("Cairo")
- geoip.continent_name: keyword ("Africa")
- geoip.country_iso_code: keyword ("EG")
- geoip.location: geo_point ([object Object])
- geoip.region_name: keyword ("Cairo Governorate")
- manufacturer: text ("Elitelligence,Oceanavigations")
- order_date: date (2023-06-05T09:28:48+00:00)
- order_id: keyword ("584677")
- products._id: text (null)
- products.base_price: half_float (null)
- products.base_unit_price: half_float (null)
- products.category: text (null)
- products.created_on: date (null)
- products.discount_amount: half_float (null)
- products.discount_percentage: half_float (null)
- products.manufacturer: text (null)
- products.min_price: half_float (null)
- products.price: half_float (null)
- products.product_id: long (null)
- products.product_name: text (null)
- products.quantity: integer (null)
- products.sku: keyword (null)
- products.tax_amount: half_float (null)
- products.taxful_price: half_float (null)
- products.taxless_price: half_float (null)
- products.unit_discount_amount: half_float (null)
- sku: keyword ("ZO0549605496,ZO0299602996")
- taxful_total_price: half_float (36.98)
- taxless_total_price: half_float (36.98)
- total_quantity: integer (2)
- total_unique_products: integer (2)
- type: keyword ("order")
- user: keyword ("eddie")
PPL Output:
source=\`ecommerce\` | where MATCH(\`category\`, 'clothing') AND \`order_date\` < DATE_SUB(NOW(), INTERVAL 7 DAY) | stats AVG(\`taxful_total_price\`) AS \`avg_price\`
